alert http any any -> any any ( \
    msg:"HTTP Body Bash Reverse Shell"; \
    flow:established,to_client; \
    http.response_body; \
    content:"bash"; \
    http.response_body; \ 
    content:"/dev/tcp/"; \
    classtype:trojan-activity; \
    sid:3000001; \ 
    rev:1; \
)
alert http any any -> any any \
    (msg:"HTTP Body Reverse Shell raw TCP/UDP socket"; \
    flow:established,to_client; \
    http.response_body; \
    pcre:"/\/dev\/(tcp|udp)\/[0-9]{1,3}(\.[0-9]{1,3}){3}\/[0-9]{1,5}/i"; \
    classtype:trojan-activity; \
    sid:3000002; \
    rev:1;\
)
alert tcp any any -> any any ( \
    msg:"Raw TCP Reverse Shell Prompt"; \
    flow:established; \
    pcre:"/^[\w-]+@[\w.-]+:\/[\w\/.-]+[$#] /m"; \
    classtype:trojan-activity; \
    sid:3000003; \
    rev:1; \
)